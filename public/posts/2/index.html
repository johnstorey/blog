

<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>John Dreams</title>
  <meta name="author" content="John Storey">
  <link rel="author" href="humans.txt">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

  
    
  
  <meta name="description" content=" ">
  
  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://blog.johnstorey.org/posts/2/">
  <link href="/favicon.png" rel="icon">
  <link href='http://fonts.googleapis.com/css?family=Cantarell' rel='stylesheet' type='text/css'>
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="John Dreams" type="application/atom+xml">
  <meta name="og:type" content="website" />
  <meta name="og:site_name" content="John Dreams" />
  <meta name="og:title" content="John Dreams" />
  <meta name="og:description" content=" " />
  <meta name="og:url" content="http://blog.johnstorey.org/posts/2/index.html"/>
  <meta name="url" content="http://blog.johnstorey.org/posts/2/index.html">
  
  <meta name="distribution" content="global">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-52702218-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <div id="front-wrapper">
  <div id="hero">
    <div id="hero-inner" class="container">
      <div class="span10 offset1">
  <h1>
    John Dreams
  </h1>
  <h2>A blog about faith, tech and management.</h2>
</div>

    </div>
  </div>
  <section id="sub-hero">
    <div class="container">
      <div class="row">
  <div class="span4">
    <h2>about me</h2>
<p>A little something about me.</p>

  </div>
  <div class="span6">
    
<h2>recent public projects</h2>
<dl id="gh_repos" class="dl-horizontal" data-github-user="johnstorey" data-github-repo-count="0" data-github-skip-forks="true" data-github-skip-github-io="">
  <dd class="loading">Status updating&#8230;</dd>
</dl>
<script src="/javascripts/github.js" type="text/javascript"> </script>
<script src="/javascripts/libs/jXHR.js" type="text/javascript"> </script>


  </div>
  <div class="span2">
    <h2>found on</h2>

<a href="https://github.com/johnstorey/" rel="tooltip" title="Github"><img class="social_icon" title="Github" alt="github icon" src="/images/glyphicons_381_github.png"></a>







<a href="http://twitter.com/johnroberstorey" rel="tooltip" title="Twitter"><img class="social_icon" title="Twitter" alt="Twitter icon" src="/images/glyphicons_391_twitter_t.png"></a>


















  </div>
</div>

    </div>
  </section>
  <div class="container">
    <div class="row" id="post-container">
    
    
    
      <article class="span4">
        <div class="article-format">

  <header>
    
      <!-- Now we're back to normal posts. Note the links used under href in both headers.--> 
        <h1 class="entry-title"><a href="/blog/2012/09/29/first-polyphasic-friday/">First Polyphasic Friday</a></h1>
        
    
    
      <p class="meta">
        
  


  
    <span class="byline author vcard">by <span class="fn">John Storey</span></span>
  

 - 
        








  


<time datetime="2012-09-29T00:04:00-07:00" pubdate data-updated="true">Sep 29<sup>th</sup>, 2012</time> - 
        

posted in
<span class="categories">
  
    <a class='category' href='/blog/categories/polyphasic/'>polyphasic</a>
  
</span>


        
         | <a href="/blog/2012/09/29/first-polyphasic-friday/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Here it is midnight on my first weekend on Everyman 3. I lay down for 20 minutes at 10:30 PM, and now I&rsquo;m awake until 3 AM when I take a 3 hour sleep. That&rsquo;s the big sleep for the day, and the majority of the 4 hours a day rest.</p>

<p>So far it&rsquo;s good. I&rsquo;ve been allowing myself a cup of coffee when I first wake from a nap, but now I am wondering if it is interfering with my ability to take my naps. True, I am on day 4 and it is supposed to take a month to fully adapt, but I still feel I don&rsquo;t get to sleep fast enough on the 20 minute nap. In another week I&rsquo;ll have to see where I am &hellip;</p>

<p>My mental faculties are ok, but not the top of where they can be. I am not fully rested &mdash; but I am as rested as I was on a normal weeknights sleep. This is the first night to myself where I don&rsquo;t need to work with the offshore teams. I&rsquo;ve continued working on my long, backlogged TODO list. Today I fixed this blog and put it on GitHub. After 4 months I finally got the email at johnstorey.org working again. After I complete this post my plan is to evaluate ZSH as a Bash replacement. If I have time and motivation after that I will start going through the MIT Open Courseware classes for Scheme. I last programmed a Lisp language about 24 years ago (ouch! getting old, aren&rsquo;t I!). Scheme did not exist back then boys and girls. But these days I keep bumping into Clojure, which is Lisp based. My thought is to</p>

<ul>
<li>Learn Scheme.</li>
<li>Review the MIT Open Courseware algorithm classes that are in Scheme.</li>
<li>Work through a paper I found to write a Scheme compiler in Scheme.</li>
</ul>


<p>This will meet the goals I have of</p>

<ul>
<li>Getting back into a functional language.</li>
<li>Lay a foundation for Emacs scripting.</li>
<li>Refresh my algorithms knowledge &mdash; every developer needs to do this every few years.</li>
<li>Write a compiler, which strangely, I&rsquo;ve never done. In concept it seems simple. Read some text, follow rules to transform it, and end up with the final transform creating assembly or object code.</li>
</ul>


<p>Not sure how far I will get on the Scheme front tonight as I am feeling an urge to space out and watch Season 3 of Fringe on Amazon. But it would be good to start.</p>

<p>I am enjoying the extra free time. I event started a light exercise routine again. At 11 PM I was the only one in the fitness center on a Friday night. The security guard gave me strange looks as she walked by, but hey, I <em>am</em> living unusual hours right now. I&rsquo;ll monitor how the exercise interacts with my sleep schedule and overall rest.</p>

<p>Now, on to that ZSH evaluation &hellip;</p>
</div>
  
  
  


</div>

      </article>
    
    
      <article class="span4">
        <div class="article-format">

  <header>
    
      <!-- Now we're back to normal posts. Note the links used under href in both headers.--> 
        <h1 class="entry-title"><a href="/blog/2012/09/28/blog-reboot/">Blog Reboot</a></h1>
        
    
    
      <p class="meta">
        
  


  
    <span class="byline author vcard">by <span class="fn">John Storey</span></span>
  

 - 
        








  


<time datetime="2012-09-28T10:30:00-07:00" pubdate data-updated="true">Sep 28<sup>th</sup>, 2012</time> - 
        


        
         | <a href="/blog/2012/09/28/blog-reboot/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>As you can see, after much time, my blog has been restarted and moved to GitHub. Of course it&rsquo;s probably the 3rd or 4th blog start in my life, and I have lost more information than I&rsquo;ve kept. But trying again. Here are the highlights.</p>

<h1>Still on Octopress</h1>

<p>I don&rsquo;t see myself leaving <a href="http://octopress.org">Octopress</a> as a solution any time soon. It&rsquo;s very OS agnostic and fits nicely into my workflow. I&rsquo;ve even installed a custom theme (that took about 2 minutes &mdash; I love todays world.)</p>

<h1>Moved to GitHub Pages</h1>

<p>Secondly, johnstorey.org continues to have issues. I believe I&rsquo;ll get the email working again but won&rsquo;t bother hosting the blog on S3 again. Since I was hosted there GitHub has apparently started a service where you can have one repository served up as webpages called GitHub Pages. You can use the built in support for them in Octopress by following the directions <a href="http://http://robdodson.me/blog/2012/04/30/custom-domain-with-octopress-and-github-pages/">here</a>.</p>

<p>Score!</p>

<p>There were some minor issues, such as my existing RVM / Ruby installation with Octopress did not work. But I installed Ruby 1.9.3 support under RVM, downlodade a clean Octopress repository, and was soon up and running. The main problem was that Xcode made me click &lsquo;Install Command line tools&rsquo; explicitly. Silly Apple &mdash; that should be the default!</p>

<p>So between polyphasic sleeping and the ease of use of GitHub Pages maybe you&rsquo;ll see more frequent posts here!</p>
</div>
  
  
  


</div>

      </article>
    
    
      <article class="span4">
        <div class="article-format">

  <header>
    
      <!-- Now we're back to normal posts. Note the links used under href in both headers.--> 
        <h1 class="entry-title"><a href="/blog/2012/09/27/trying-polyphasic-sleeping/">Trying Polyphasic Sleeping</a></h1>
        
    
    
      <p class="meta">
        
  


  
    <span class="byline author vcard">by <span class="fn">John Storey</span></span>
  

 - 
        








  


<time datetime="2012-09-27T20:10:00-07:00" pubdate data-updated="true">Sep 27<sup>th</sup>, 2012</time> - 
        

posted in
<span class="categories">
  
    <a class='category' href='/blog/categories/polyphasic/'>polyphasic</a>
  
</span>


        
         | <a href="/blog/2012/09/27/trying-polyphasic-sleeping/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>It&rsquo;s been a long time since I&rsquo;ve posted. Why? Because my job takes up 100% of my time, and my girlfriend another 30%. Life has gone back to extreme craziness.</p>

<p>Finally I was speaking to a client about <em>The Four Hour Body</em>, which I have yet to read. He spoke about polyphasic sleeping, which rang a bell in my head from years ago &hellip;</p>

<p>People are functional on 2 hours sleep? Say what? It&rsquo;s true. That&rsquo;s called the &ldquo;Uberman&rdquo; in the polyphasic world, and it&rsquo;s the most hard core you can get. All you do is nap every 4 hours. No other sleep.</p>

<p>Ouch.</p>

<p>But for 7+ years the IT staffer <a href="http://www.puredoxyk.com/index.php/polyphasic-sleep-portal/">puredoxyk</a>  has lived the &ldquo;Everyman 3&rdquo; schedule. In this plan you sleep three hours a night and have 3 daily naps of 20 minutes, for a total of 4 hours of sleep in 24. Better, it is a schedule that allows you to interact with the rest of humanity. Now I have people I talk to daily 12 and 13 timezones away. So I&rsquo;m often talking to them in the middle of the night, then with clients the next day. If there was only a way to be functional while doing that I could really smooth things out in many projects. Plus I could blog more, work on the novel plot, learn Clojure, review Calculus (I&rsquo;m ashamed to say I&rsquo;ve forgotten most of it), and more &hellip;</p>

<p>I&rsquo;m truly insane. It&rsquo;s day 3 now. My body is starting to adapt &mdash; or so I think. I didn&rsquo;t really maintain a great sleep schedule before, so it&rsquo;s hard to say. But yesterday I started actually sleeping during the 20 minute naps. I believe I am dreaming, but as before, I don&rsquo;t seem to remember 99% of my dreams. Today I woke from my 20 minute nap relaxed and refreshed. That should be a sign that REM sleep has been experienced.</p>

<p>Also, in the last 3 days, I&rsquo;ve accomplished more than I usually do in a week.</p>

<p>We&rsquo;ll see how well this lasts. It is supposed to take a month to really get your body used to it. The extra time is super useful in today&rsquo;s world though. I feel like back in the 90s when I did Atkins. Everyone thought it would kill me somehow. Instead there was a decrease in my waist from 48&#8221; to 33&#8221;. Could polyphasic sleeping be a repeat?</p>

<p>Stay tuned. See if I last!</p>
</div>
  
  
  


</div>

      </article>
    
    
      <article class="span4">
        <div class="article-format">

  <header>
    
      <!-- Now we're back to normal posts. Note the links used under href in both headers.--> 
        <h1 class="entry-title"><a href="/blog/2012/05/04/investments-on-sale-again/">Investments on Sale - Again!</a></h1>
        
    
    
      <p class="meta">
        
  


  
    <span class="byline author vcard">by <span class="fn">John Storey</span></span>
  

 - 
        








  


<time datetime="2012-05-04T12:13:00-07:00" pubdate data-updated="true">May 4<sup>th</sup>, 2012</time> - 
        

posted in
<span class="categories">
  
    <a class='category' href='/blog/categories/investing/'>investing</a>
  
</span>


        
         | <a href="/blog/2012/05/04/investments-on-sale-again/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Lately I&rsquo;ve been turning my eye back to my investments, primarily in equities. Well, really, since doing my takes and updating the retirement plan.</p>

<p>I&rsquo;m here to say: the news is good for the bargain hunter.</p>

<p>Marc Faber popped up in the Wall Street Journal today with a viewpoint that I believe: the U.S. market can see another 20% decline.</p>

<p>Helping dollar destruction, Bernanke seems poised to do QE3, even if it may be under another name.</p>

<p>Europe is the U.S. 2009 (oh, did I make money in oil futures that year? I did!). Spain is undoubtedly being combed by bargain hunters, but there is likely enough for everyone. With companies that have nice exposure to emerging markets in Latin America.</p>

<p>France is likely to elect Holland to run the place. Can we say an end to austerity in the Euro zone, cheap money everywhere, and more currency destruction.</p>

<p>Yes, I&rsquo;m really thinking alot about commodities again.</p>

<p>Other trends: we are a few years away from Social Security and Medicare running out in the U.S. That is a mega event beyond compare, and to be honest, I&rsquo;m not ready to take advantage of it. Time to make a plan.</p>

<p>There are some relevant factoids that should make any investor step back and reflect. There is lots going on here and values should pop up left and right, if only we can dig them out.</p>
</div>
  
  
  


</div>

      </article>
    
    
      <article class="span4">
        <div class="article-format">

  <header>
    
      <!-- Now we're back to normal posts. Note the links used under href in both headers.--> 
        <h1 class="entry-title"><a href="/blog/2012/04/19/wtf-apple/">WTF Apple ?!?</a></h1>
        
    
    
      <p class="meta">
        
  


  
    <span class="byline author vcard">by <span class="fn">John Storey</span></span>
  

 - 
        








  


<time datetime="2012-04-19T10:10:00-07:00" pubdate data-updated="true">Apr 19<sup>th</sup>, 2012</time> - 
        

posted in
<span class="categories">
  
    <a class='category' href='/blog/categories/personal/'>personal</a>
  
</span>


        
         | <a href="/blog/2012/04/19/wtf-apple/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Apple! My confused little company that brings beauty to computing. A little heart to heart. You, me, and the internet.</p>

<p>What misbegotten security theatre meme makes you suddenly want 3 &mdash; 3! &mdash; questions answered before you let me download more apps to my iPad 3? Why, of all the questions, are they so strange that I can only answer one? Why not let me choose the questions AND the answers? Why not let me opt out? Why is it so hard to buy things using you as a channel?</p>

<p>Let me calm down.</p>

<p>Look, more factors of authentication is not the answer. You quickly get past the point where the irritation is greater than the benefits. I will now go and fill in random answers to your random questions. You have wasted my time to the benefit of neither of us, and really irritated me.</p>

<p>Is this what you wanted?</p>
</div>
  
  
  


</div>

      </article>
    
    
      <article class="span4">
        <div class="article-format">

  <header>
    
      <!-- Now we're back to normal posts. Note the links used under href in both headers.--> 
        <h1 class="entry-title"><a href="/blog/2012/04/11/drupalizing-a-web-project/">Drupalizing a Web Project</a></h1>
        
    
    
      <p class="meta">
        
  


  
    <span class="byline author vcard">by <span class="fn">John Storey</span></span>
  

 - 
        








  


<time datetime="2012-04-11T08:45:00-07:00" pubdate data-updated="true">Apr 11<sup>th</sup>, 2012</time> - 
        

posted in
<span class="categories">
  
    <a class='category' href='/blog/categories/drupal/'>drupal</a>
  
</span>


        
         | <a href="/blog/2012/04/11/drupalizing-a-web-project/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>These are notes from <a href="http://dev.nodeone.se/en/drupalizing-a-web-project">http://dev.nodeone.se/en/drupalizing-a-web-project</a> for myself. Yes, a blog post summarizing a blog post. Just think of this as a page in my notebook. Without the dead trees.</p>

<ol>
<li>Understand the problem domain, likely issues, and needed functionality.</li>
<li>Map out content types and entities.</li>
<li> Access control.</li>
<li> Reuse across site?</li>
<li> Inter-relationships?</li>
<li>User groups and their properties.</li>
<li> Roles.</li>
<li> Profiles.</li>
<li> Etc.</li>
<li>Consider views into the data.</li>
<li>Consider business rules that can be put in Rules module.</li>
<li>Look at what this process might have missed.</li>
<li>Non-IA</li>
<li> Performance and scalability.</li>
<li> Localization and internationalization.</li>
<li> Data migration.</li>
<li> Integration</li>
<li> Etc.</li>
</ol>

</div>
  
  
  


</div>

      </article>
    
    
      <article class="span4">
        <div class="article-format">

  <header>
    
      <!-- Now we're back to normal posts. Note the links used under href in both headers.--> 
        <h1 class="entry-title"><a href="/blog/2012/02/14/adventures-in-drupal-services-endpoints/">Adventures in Drupal Services Endpoints</a></h1>
        
    
    
      <p class="meta">
        
  


  
    <span class="byline author vcard">by <span class="fn">John Storey</span></span>
  

 - 
        








  


<time datetime="2012-02-14T10:06:00-08:00" pubdate data-updated="true">Feb 14<sup>th</sup>, 2012</time> - 
        

posted in
<span class="categories">
  
    <a class='category' href='/blog/categories/drupal/'>drupal</a>
  
</span>


        
         | <a href="/blog/2012/02/14/adventures-in-drupal-services-endpoints/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Adventures with Drupal Services</p>

<p>If you are writing a web services interface on top of Drupal 7, you might be tempted to do something like use menu callbacks. The menu system in Drupal really is just a bunch of code that is called and spits back HTML for you. It&rsquo;s common to write your own menu code that takes and spits back whatever you want. Now that I think of it, this is probably how the Drupal Services module is written way down. There is certainly no immediately obvious reason not to do it that way.</p>

<p>These are some notes I found while getting a simple services module written. They, like my current knowledge, are incomplete. In many areas I have yet to fathom why they are like this. My concern is limited to the use of the REST Server in the Services 3 code.</p>

<h1>More than CRUD.</h1>

<p>All this section comes from reading the code in services/servers/rest_server/includes/RESTServer.inc., particularly the method <strong>resolveController()</strong>. This method is the source of the most common error when writing your own services &mdash; <strong>Cannot find controller</strong>. It is worth your time to read the code and get a sense of how it works.</p>

<p>Services has CRUD hardwired into it. It assumes the following CRUD methods:</p>

<ul>
<li>retrieve</li>
<li>create</li>
<li>update</li>
<li>delete</li>
</ul>


<p>Now this is clearly not enough to make a pretty, full featured REST API. So Services 3 allows you to add in two other types of API endpoints.</p>

<h2>Actions.</h2>

<p>According to the README for the REST server for services, actions</p>

<p><quote>
are performed directly on the resource type, not an individual resource.
</quote></p>

<p>An example is given of telling a search engine to reindex itself. This does not act on any particular piece of content, but rather works across all the content at one time.</p>

<p>For my purposes I wanted to use more descriptive names on my endpoints than, say, &lsquo;create&rsquo; so I only used actions. But I could have easily given an alias to the create endpoint in the code. In retrospect I should have gone that way but we&rsquo;ll look at code using actions for everything in this post.</p>

<h2>Targeted Actions.</h2>

<p>These are like actions, something that does not fit in the default CRUD API layout. The difference is that these work on an particular piece of content. For example, an endpoint might tell Drupal to append some content to an entity.</p>

<p>POST <a href="http://example.com/api/entity/123/append/run%20concluded">http://example.com/api/entity/123/append/run%20concluded</a></p>

<p>This hypothetical call would append the string &ldquo;run concluded&rdquo; to some field on the entity with etid 123.</p>

<p>I did not use targeted actions, so they won&rsquo;t be in the code in this post, but the idea is prett simple.</p>

<h2>Relations.</h2>

<p>Relations are a little different in that they retrieve content related to the content in question. For example, you might want an API to get a list of all files associated with a particular entity. You might want it to read like this</p>

<p>GET <a href="http://example.com/api/entity/243/filelist">http://example.com/api/entity/243/filelist</a></p>

<p>Pretty simple when you understand it. These terms are all used in the documentation, but how to create anything other than the basic CRUD endpoints in your custom code is not explained. We&rsquo;ll be showing you how to create custom actions (discerned from studying how the code works) here. Presumably relations are not all that different, but I will not swear to it.</p>

<h2>Why all the different types?</h2>

<p>I can only assume that there is some REST specification of which I am unaware. It seems fine to me to make them all &lsquo;actions&rsquo;, which is much like saying &lsquo;menu callbacks&rsquo;. The code for the REST server would be simplified, as would writing hooks for it. But Greg Dunlap has been doing Services for quite some time, and I have faith that he led a total rewrite of the framework for a reason. So for now I am concerning myself with what is, rather than why it is that way.</p>

<p>(brief pause as plane is landing and I need to shut off the laptop.)</p>

<h1>Some code &mdash; finally!</h1>

<p>At the end of the day, the best thing turns out to study the <strong>resolveController()</strong> method in <strong>RESTServer.inc</strong>, as explained above. Then look at the implementations of <strong>hook_services_resources()</strong> in the directory <strong>services/resources</strong>. They will show you how to declare actions.</p>

<p>With all this background, we can finally do the actual simple part: write the code.</p>

<h2>Hooks away!</h2>

<p>Some days I love Drupal&rsquo;s hook system. It makes coding so pleasurable. Other times I wonder about bootstrap costs. But that&rsquo;s another story.</p>

<p>First, let&rsquo;s declare a simple api with actions only and no CRUD. Here are some custom entry points for the &lsquo;drupalchat&rsquo; endpoint. Also notice that the &lsquo;messagecreate&rsquo; endpoint takes a &lsquo;struct&rsquo; type of parameter, which is populated by Services with payload data for a POST call. For the sake of simplicity we&rsquo;ll not comment on the standard access callback.</p>

<p><code>
/<em>*
 * Implements hook_services_resources().
 </em>/
function chat_rest_services_resources() {
  $resources[&lsquo;drupalchat&rsquo;] = array();
  $resources[&lsquo;drupalchat&rsquo;][&lsquo;actions&rsquo;] = array(</p>

<pre><code>'messagecreate' =&gt; array(
  'help' =&gt; 'Send a new chat message.',
  'callback' =&gt; '_chat_rest_send_msg',
  'access callback' =&gt; 'chat_rest_access',
  'access arguments' =&gt; array('create'),
  'access arguments append' =&gt; TRUE,
  'args' =&gt; array(
    array(
      'name' =&gt; 'data',
      'type' =&gt; 'struct',
      'description' =&gt; 'Recipient user id and message to send.',
      'source' =&gt; 'data',
      'optional' =&gt; FALSE,
    ),
  ),
),
'newmessages' =&gt; array(
  'help' =&gt; 'Get any new chat messages.',
  'callback' =&gt; '_chat_rest_retrieve',
  'access callback' =&gt; 'chat_rest_access',
  'access arguments' =&gt; array('new'),
  'access arguments append' =&gt; TRUE,
),
'updatebuddylist' =&gt; array(
  'help' =&gt; 'Get currently buddy list status.',
  'callback' =&gt; '_chat_rest_buddylist',
  'access callback' =&gt; 'chat_rest_access',
  'access arguments' =&gt; array('new'),
  'access arguments append' =&gt; TRUE,
),
</code></pre>

<p>  );</p>

<p>  return $resources;
}
</code></p>

<p>Lastly, define the endpoints to be shown in the Services configuration page.</p>

<p><code>
function chat_rest_default_services_endpoint() {
  $endpoint = new stdClass;
  $endpoint->disabled = FALSE; // endpoint disabled initially
  $endpoint->name = &lsquo;drupalchat&rsquo;;
  $endpoint->title = &lsquo;Drupalchat REST API&rsquo;;
  $endpoint->server = &lsquo;rest_server&rsquo;;
  $endpoint->path = &lsquo;js-api&rsquo;;
  $endpoint->authentication = array(</p>

<pre><code>'drupalchat' =&gt; array(
  'alias' =&gt; '',
  'actions' =&gt; array(
    'messagecreate' =&gt; array(
      'enabled' =&gt; 1,
    ),
    'newmessages' =&gt; array(
      'enabled' =&gt; 1,
    ),
    'updatebuddylist' =&gt; array(
      'enabled' =&gt; 1,
    ),
  ),
),
</code></pre>

<p>  );</p>

<p>  // TODO turn this debug to 0
  $endpoint->debug = 1;
  $endpoints[] = $endpoint;
  return $endpoints;
}
</code></p>

<p>That&rsquo;s it! Declaring a custom Services endpoint (or here, 3)  really is not that difficult once you understand how to do it.</p>
</div>
  
  
  


</div>

      </article>
    
    
      <article class="span4">
        <div class="article-format">

  <header>
    
      <!-- Now we're back to normal posts. Note the links used under href in both headers.--> 
        <h1 class="entry-title"><a href="/blog/2012/02/14/new-post/">New-post</a></h1>
        
    
    
      <p class="meta">
        
  


  
    <span class="byline author vcard">by <span class="fn">John Storey</span></span>
  

 - 
        








  


<time datetime="2012-02-14T10:05:00-08:00" pubdate data-updated="true">Feb 14<sup>th</sup>, 2012</time> - 
        


        
         | <a href="/blog/2012/02/14/new-post/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content">
</div>
  
  
  


</div>

      </article>
    
    
      <article class="span4">
        <div class="article-format">

  <header>
    
      <!-- Now we're back to normal posts. Note the links used under href in both headers.--> 
        <h1 class="entry-title"><a href="/blog/2012/01/07/deficencies-with-vagrant/">Deficencies With Vagrant</a></h1>
        
    
    
      <p class="meta">
        
  


  
    <span class="byline author vcard">by <span class="fn">John Storey</span></span>
  

 - 
        








  


<time datetime="2012-01-07T08:13:00-08:00" pubdate data-updated="true">Jan 7<sup>th</sup>, 2012</time> - 
        

posted in
<span class="categories">
  
    <a class='category' href='/blog/categories/drupal/'>drupal</a>, <a class='category' href='/blog/categories/vagrant/'>vagrant</a>
  
</span>


        
         | <a href="/blog/2012/01/07/deficencies-with-vagrant/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I love the Vagrant project. Someday, hopefully soon, I&rsquo;ll be able to switch my whole developer organization over to using it. Here&rsquo;s a note to myself about what needs to happen first. I&rsquo;m posting so I can refer back from time to time and see if it&rsquo;s something we can use now (don&rsquo;t look at me, I&rsquo;m hacking on (Drupal)[<a href="http://drupal.org/">http://drupal.org/</a>]).</p>

<h1>Cannot Run in Bridged Mode</h1>

<p>You know what? For some reason in Virtual Box XDebug can only talk to a host  debugger if it&rsquo;s running in bridged networking mode. Unfortunately that is not a current Vagrant feature. I have seen a patch to network.rb that does not seem to work for me. Also I heard there is a patch in branch on Debian that was recently submitted.</p>

<p>On a personal level, if anyone can help me get XDebug working on OSX Lion and talking to MacGDP back on the host, I&rsquo;d greatly appreciate it. For my own work.</p>

<h1>Cannot Run on Windows Well</h1>

<p>This is a problem with gems that use native DLLs. Why do I care? <em>I</em> don&rsquo;t. Windows can disappear off the surface of hard drives across the planet for my money. But much of my company is full of developers who don&rsquo;t and don&rsquo;t desire to learn to work with anything other than Windows. I&rsquo;m just not going to move them anytime soon.</p>

<p>Unfortunately here is a current reality</p>

<ul>
<li>On Windows, Vagrant does not work on Ruby.</li>
<li>It does work on JRuby.</li>
<li>JRuby does not allow gems that use native API components.</li>
<li>Chef requires native API components.</li>
</ul>


<h1>When These Issues Resolve</h1>

<p>I&rsquo;ll be able to move the organization to Vagrant. Until then I&rsquo;ll get some of the value by distributing virtual machines and letting people share their source code folders into it.</p>

<p>It&rsquo;s annoying though. Vagrant is a great piece of software.</p>
</div>
  
  
  


</div>

      </article>
    
    
      <article class="span4">
        <div class="article-format">

  <header>
    
      <!-- Now we're back to normal posts. Note the links used under href in both headers.--> 
        <h1 class="entry-title"><a href="/blog/2012/01/01/mobile-drupal-cheap/">Mobile Drupal Made Easy</a></h1>
        
    
    
      <p class="meta">
        
  


  
    <span class="byline author vcard">by <span class="fn">John Storey</span></span>
  

 - 
        








  


<time datetime="2012-01-01T14:58:00-08:00" pubdate data-updated="true">Jan 1<sup>st</sup>, 2012</time> - 
        

posted in
<span class="categories">
  
    <a class='category' href='/blog/categories/drupal/'>drupal</a>, <a class='category' href='/blog/categories/mobile/'>mobile</a>
  
</span>


        
         | <a href="/blog/2012/01/01/mobile-drupal-cheap/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>January 1st, 2012. What a great year 2011 has been! A VP Engineering position where we turned the company around from self-immolation, and moving in with the girlfriend. No matter what else you can say, it&rsquo;s been exciting and one of the bigger growth experiences of my life. So how to top it in 2012? Hey, how to match it?</p>

<p>I have no idea. So instead I took my one week off at the end of the year (hey, turning that company around was a 7 day a week job!) to return to my favorite technology, Drupal. After some struggles with the Drupal 7 core code I can create entities and fields willy nilly. In real life it&rsquo;s almost always better to create them in the UI and export them with Features, but for really understanding what&rsquo;s happening you need to get as deep into the code as possible. So I did that, and used the knowledge to sketch out a new module idea with a friend. You should see the fruits of that around March. She&rsquo;s busy writing a book for Packt, and I have real life coming back in two days. That&rsquo;s going to slow us down.</p>

<p>Now, on to the topic of this post &hellip;</p>

<h1>Mobile Drupal Made Easy</h1>

<p>That company where they hired me in as VPE? After a year the first project has come along where Drupal seems the most appropriate answer (along with Apache Solr and possibly Node.js). We have the client kickoff the second week of January, then it&rsquo;s a pell mell rush for a three month delivery. Having had a months warning one of the first things we did was sketch out a preliminary architecture, then map out the areas where we had missing experience or an unclear idea how to proceed. One of those was in how to make mobile apps connected to Drupal in the most convienent way possible.</p>

<p>The short story was, for this client, make a standalone app makes little sense. Yes, we want to be in the app store, but we are going to use about zero percent of the native functionality. So despite a strong Sencha Touch skillset we want to try a new approach.</p>

<h1>Proposed: Responsive Web in a Phone Gap Wrapper</h1>

<p>We plan to create a responsive web design (we&rsquo;ve done some internal development tests with the Omega Theme to great success.) Then wrap it in PhoneGap or Sencha Touch wrapped in Phone Gap. That&rsquo;s the part we have not tried yet.</p>

<p>So I have a full day until real life work starts up. The emails already indicate the client pressure will be huge, and the new project starting up won&rsquo;t lessen anything. Let&rsquo;s see if you get a post showing PhoneGap wrapping XHTML and sized with a responsive web design. I have high hopes the approach will work fine because (a) it makes sense, and (b) it turns out there is a session on how to do the same thing being given at Drupalcon Denver in March.</p>

<p>Look for a post showing how to do this over the next few weeks.</p>

<p>Happy New Year!
John</p>
</div>
  
  
  


</div>

      </article>
    
    </div>
      <div class="row">
        <ul class="pager">
          
            <li class="previous">
              <a href="3">&larr; Older</a>
            </li>
          
          
            <li class="next">
              <a class="next" href="1">Newer &rarr;</a>
            </li>
          
        </ul>
      </div>
  </div>
</div>


  <div id="footer-widgets">
  <div class="container">
    <div class="row">
  <div class="span3">
    <h2>recent posts</h2>
    <ul class="recent_posts">
      
        <li>
          <a href="/blog/2014/08/18/drupal-7-put-user-fields-in-features/">Drupal 7 Put User Fields in Features</a>
        </li>
      
        <li>
          <a href="/blog/2014/07/31/drupal-7-services-7-dot-x-3-dot-7/">Drupal 7 Services 7.x-3.7</a>
        </li>
      
        <li>
          <a href="/blog/2014/07/09/drupal-access-grants/">Drupal Access Grants</a>
        </li>
      
        <li>
          <a href="/blog/2012/12/06/emacs-dired-nodes/">Emacs Dired Nodes</a>
        </li>
      
        <li>
          <a href="/blog/2012/11/14/emacsclient-ignores-init-file/">Emacsclient Ignores Init File</a>
        </li>
      
    </ul>
    <h2><a href="/blog/archives">archives</a></h2>
  </div>
  <div class="span3">
    

  </div>
  <div class="span4">
    
<h2>twitter</h2>
<a href="https://twitter.com/johnroberstorey" class="twitter-follow-button" data-show-count="true" data-lang="en">Follow @johnroberstorey</a>
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
<div class="tweet" data-twitter-user="johnroberstorey">
</div>


  </div>
  <div class="span2">
    <h2>found on</h2>

<a href="https://github.com/johnstorey/" rel="tooltip" title="Github"><img class="social_icon" title="Github" alt="github icon" src="/images/glyphicons_381_github.png"></a>







<a href="http://twitter.com/johnroberstorey" rel="tooltip" title="Twitter"><img class="social_icon" title="Twitter" alt="Twitter icon" src="/images/glyphicons_391_twitter_t.png"></a>


















  </div>
</div>

  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-left">
  <a href="/">John Dreams</a>
  - Copyright &copy; 2014 - John Storey
</p>
<p class="pull-right">
  <span>Powered by <a href="http://octopress.org/">Octopress</a>.</span>
  
    <span>Designed by <a href="http://www.AdrianArtiles.com">Adrian Artiles</a>.</span>
  
</p>

  </div>
</footer>

  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js" type="text/javascript"></script>
<script>window.jQuery || document.write('<script src="/javascripts/libs/jquery-1.7.2.min.js" type="text/javascript"><\/script>')</script>
<script src="/javascripts/libs/bootstrap.min.js" type="text/javascript"></script>
<script src="/javascripts/jquery.tweet.js" type="text/javascript"></script>
<script src="/javascripts/jquery.instagram.js" type="text/javascript"></script>
<script src="/javascripts/libs/jquery.masonry.min.js" type="text/javascript"></script>
<script src="/javascripts/custom.js" type="text/javascript"></script>


<script type="text/javascript">
      var disqus_shortname = 'blogjohnstoreyorg';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>




</body>
</html>
